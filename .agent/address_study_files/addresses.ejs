<%- include('../partials/header') %>
    <!-- Link to Separate CSS -->
    <link rel="stylesheet" href="/css/user/address.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="/css/user/homestyle.css">

    <div class="address-container">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h2>My Addresses</h2>
            <button class="btn-add" onclick="openAddModal()">+ Add New Address</button>
        </div>

        <div id="addressList">
            <% if (addresses && addresses.length> 0) { %>
                <% addresses.forEach(addr=> { %>
                    <div class="address-card">
                        <h3>
                            <%= addr.name %>
                        </h3>
                        <p>
                            <%= addr.address_line1 %>, <%= addr.address_line2 %>
                        </p>
                        <p>
                            <%= addr.city %>, <%= addr.state %> - <%= addr.postal_code %>
                        </p>
                        <p>Phone: <%= addr.phone %>
                        </p>

                        <div class="actions">
                            <button onclick="editAddress('<%= addr._id %>')"
                                style="background-color: #007bff;">Edit</button>
                            <button onclick="deleteAddress('<%= addr._id %>')"
                                style="background-color: #dc3545;">Delete</button>
                        </div>
                    </div>
                    <% }) %>
                        <% } else { %>
                            <p>No addresses found. Add one now!</p>
                            <% } %>
        </div>
    </div>

    <!-- Add Address Modal -->
    <div id="addressModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="document.getElementById('addressModal').style.display='none'">&times;</span>
            <h2>Add New Address</h2>

            <form id="addressForm">
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="name" name="name" required>
                </div>

                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="text" id="phone" name="phone" required>
                </div>

                <div class="form-group">
                    <label>Address Line 1</label>
                    <input type="text" id="address_line1" name="address_line1" required>
                </div>

                <div class="form-group">
                    <label>Address Line 2 (Optional)</label>
                    <input type="text" id="address_line2" name="address_line2">
                </div>

                <div class="form-group">
                    <div style="display: flex; gap: 10px;">
                        <div style="flex: 1;">
                            <label>City</label>
                            <input type="text" id="city" name="city" required>
                        </div>
                        <div style="flex: 1;">
                            <label>State</label>
                            <input type="text" id="state" name="state" required>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Postal Code</label>
                    <input type="text" id="postal_code" name="postal_code" required>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="defaultShipping" name="is_default_shipping"> Set as default shipping
                        address
                    </label>
                </div>

                <button type="submit" class="btn-add" style="width: 100%;">Save Address</button>
            </form>
        </div>
    </div>

    <!-- SweetAlert Script -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Link to Separate JS -->
    <script src="/js/user/address.js"></script>

    <%- include('../partials/footer') %>